// Summary: simplified transparency code + added volumetric fog + added unclamped directional toggle
// Generated by Microsoft (R) HLSL Shader Compiler 9.26.952.2844
//
// Parameters:
//
//   sampler2D StippleTexture;
//   sampler2D TextureSampler;
//   float4 gDirectionalColour;
//   float4 gDirectionalLight;
//   float4 gLightAmbient0;
//   float4 gLightAmbient1;
//   float4 globalFogColor;
//   float4 globalFogColorN;
//   row_major float4x4 gViewInverse;
//   float4 globalFogParams;
//   float4 globalScalars;
//   float specularColorFactor;
//   float specularFactor;
//
//
// Registers:
//
//   Name                Reg   Size
//   ------------------- ----- ----
//   gViewInverse        c12      1
//   gDirectionalLight   c17      1
//   gDirectionalColour  c18      1
//   gLightAmbient0      c37      1
//   gLightAmbient1      c38      1
//   globalScalars       c39      1
//   globalFogParams     c41      1
//   globalFogColor      c42      1
//   globalFogColorN     c43      1
//   specularFactor      c66      1
//   specularColorFactor c72      1
//   TextureSampler      s0       1
//   StippleTexture      s10      1
//

    ps_3_0
    def c219, 1.8395173895e+25, 3.9938258725e+24, 4.5435787456e+30, 5.1007264101e-43 // 364
    def c151, 0.3125, 0, 0, 0
    def c140, 1e-6, 0.5, -0.0625, 0.9375
    def c141, 0.6, 4, 1, 30
    def c142, 1000, 0, 0, 0
    def c0, 9.99999975e-006, -0.5, 0.5, -0.25
    def c1, 1.33333337, 1, 3.99600005, 4
    def c2, 9.99999975e-005, 0, 0, 0
    def c3, 0.125, 0, -1, -0
    dcl_texcoord v0.xy
    dcl_texcoord1 v1
    dcl_texcoord3 v2.xyz
    dcl_color v3.xw
    dcl vPos.xy
    dcl_texcoord6 v4.xyz
    dcl_texcoord9 v9
    dcl_2d s0
    dcl_2d s10
    texld r0, v0, s0
    add r1.xyz, c0.x, v1
    nrm r2.xyz, r1
    mul r0.w, r0.w, v3.w
    mad_sat r1.x, r2.z, c0.y, c0.z
    mov r3.xyz, c38
    mad r1.xyz, r3, r1.x, c37
    mul r3.xyz, c18.w, c18
    dp3 r1.w, r2, -c17
    // add r1.w, r1.w, c0.w
    // mul_sat r1.w, r1.w, c1.x
    mad_sat r1.w, r1.w, c220.z, c220.w
    mul r4.xyz, r3, r1.w
    mad r1.xyz, r1, v3.x, r4
    mov r1.w, c1.y
    mul r0, r0, r1
    add r20.x, r0.w, -c151.x
    texkill r20.x
    mul r0.w, r0.w, c39.x
    add r1.xyz, c0.x, v2
    nrm r4.xyz, r1
    dp3 r1.x, r4, r2
    add r1.x, r1.x, r1.x
    mad r1.xyz, r2, -r1.x, r4
    dp3_sat r1.x, -c17, r1
    add r1.x, r1.x, c2.x
    mov r2.x, c2.x
    add r1.y, r2.x, c66.x
    pow r2.x, r1.x, r1.y
    mul r1.xyz, r3, r2.x
    mul r1.xyz, r1, c17.w
    mad r0.xyz, c72.x, r1, r0
    if_eq -c210_abs.y, c210_abs.y
      add r1.x, -c41.x, v1.w
      add r1.y, -c41.x, c41.y
      rcp r1.y, r1.y
      mul_sat r1.x, r1.x, r1.y
      add r1.yzw, -r0.xxyz, c42.xxyz
      mad oC0.xyz, r1.x, r1.yzww, r0
    else
      add r20.xyz, -c15, v4.xyz
      dp3 r20.w, r20, r20
      rsq r20.w, r20.w
      mul r20.xyz, r20, r20.w
      rcp r20.w, r20.w
      
      mov r21.xyz, c212
      mad r21.w, r20.x, c140.y, c140.y
      lrp r22.xyz, r21.w, r21, c213
      mul_sat r21.x, r20.z, c212.w
      mad r21.x, r21.x, -c213.w, c213.w
      mad r21.xyz, r22, r21.x, c214
      
      dp3 r21.w, r20, c216
      
      mad_sat r22.xy, r21.w, c140.zy, c140.wy
      mul r22.z, r22.x, r22.x
      mul r22.x, r22.x, r22.z
      mov r22.z, c141.x
      add_sat r22.z, r22.z, c216_abs.z
      mad r22.x, r22.x, -r22.z, r22.y
      mul_sat r22.x, r22.x, c140.y
      mul r22.x, r22.x, c141.y
      add_sat r22.y, c141.z, -r22.x
      
      mul r23.xyz, r22.x, c215
      mul r23.xyz, r23, r23
      mul r23.xyz, r23, r23
      mad r23.xyz, r22.x, c215, r23
      mul r23.xyz, r23, c215.w
      
      mul r21.xyz, r21, r22.y
      mul_sat r21.xyz, r21, c215.w
      
      add r21.xyz, r21, r23
      mul r21.xyz, r21, c214.w
      min r21.xyz, r21, c141.w
      
      mov r22.xyz, c43
      lrp r22.xyz, c41.w, r22, r21
      
      mov r20.x, -c15.z
      mul r20.xy, r20.xz, c211.y
      mul r20.x, r20.x, c210.x
      exp r20.x, -r20.x
      
      add r20.z, r20_abs.y, -c140.x
      cmp r20.y, r20.z, r20.y, c140.x
      rcp r20.z, r20.y
      mul r20.y, r20.y, r20.w
      exp r20.y, -r20.y
      add r20.y, -r20.y, c141.z
      mul r20.y, r20.y, r20.z
      
      mul r20.x, r20.x, r20.y
      mul r20.x, r20.x, c211.x
      
      exp r20.x, -r20.x
      add r20.x, -r20.x, c141.z
      
      pow r20.x, r20.x, c211.z
      
      lrp oC0.xyz, r20.x, r22, r0
    endif
    mov oC0.w, r0.w
    
    // LogDepth Write
    mul r19.x, v9.w, c209.x
    log r19.x, r19.x
    mul r19.x, r19.x, c209.y
    rcp r19.y, v9.w
    mul r19.y, r19.y, v9.z
    cmp oDepth, -v9_abs.y, r19.y, r19.x

// approximately 58 instruction slots used (3 texture, 55 arithmetic)
